---
title: "The cost, both human and financial, of storm events"
author: "I Carter (Coursera)"
output: 
  html_document:
    keep_md: true
    toc: true
---

## Synopsis

In this project I carried out an analysis of the U.S. National Oceanic and Atmospheric Administration's (NOAA) Storm Database. I recorded my exploratory analysis in `ExploratoryAnalysis.Rmd`.

----

## Data Processing

### Read in dataset

```{r echo = TRUE}
bz <- bzfile("repdata_data_StormData.csv.bz2", "r")
data <- read.csv(bz)
close(bz)
```

----

### Most Harmful `EVTYPE`s

***Across the United States, which types of events (as indicated in the `EVTYPE` variable) are most harmful with respect to population health?***

#### How many fatalities and injuries in total?

```{r echo = TRUE}
total_deaths <- sum(data$FATALITIES)
total_deaths    ## 15145
total_injuries <- sum(data$INJURIES)
total_injuries  ## 140528
```

#### Which are the top ten fatal event types?

```{r echo = TRUE}
fatal <- tapply(data$FATALITIES, data$EVTYPE, sum)
fatal_percentage <- fatal/total_deaths * 100
fatal[which.max(fatal)]         ## which is the most fatal event type?
fatal_indices <- order(fatal, decreasing=TRUE)
fatal[fatal_indices[1:10]]
fatal_percentage[fatal_indices[1:10]]
```

#### Which are the top ten injurious event types?

```{r echo = TRUE}
injurious <- tapply(data$INJURIES, data$EVTYPE, sum)
injurious_percentage <- injurious/total_injuries * 100
injurious[which.max(injurious)]    ## which is the most injurious event type?
injurious_indices <- order(injurious, decreasing=TRUE)
injurious[injurious_indices[1:10]]
injurious_percentage[injurious_indices[1:10]]
```

## The Most Dangerous Event Types

```{r echo = TRUE}
par(mfrow=c(2, 1), cex=0.8)
barplot(fatal[fatal_indices[1:10]], axisnames=FALSE,
    col = hcl.colors(10, palette="Spectral"), legend=TRUE)
title("Top Ten Causes of Fatality")
barplot(injurious[injurious_indices[1:10]], axisnames=FALSE,
    col = hcl.colors(10, palette="Spectral"), legend=TRUE)
title("Top Ten Causes of Injury")
```

----

### Costliness

***Across the United States, which types of events have the greatest economic consequences?***

The relevant columns seem to be `PROPDMG`, `PROPDMGEXP`, `CROPDMG`, and `CROPDMGEXP`.

```{r echo = TRUE}
levels(data$PROPDMGEXP)
levels(data$CROPDMGEXP)
summary(data$CROPDMGEXP)
summary(data$PROPDMGEXP)
```

```{r echo = TRUE}
prop0 <- data[data$PROPDMG == 0,]
dim(prop0)

crop0 <- data[data$CROPDMG == 0,]
dim(prop0)
```

----

## Results

The questions that need answers are:

### Most Harmful `EVTYPE`s

Across the United States, which types of events (as indicated in the `EVTYPE` variable) are most harmful with respect to population health?

### Economic Consequences

Across the United States, which types of events have the greatest economic consequences?

----

This document was processed on: `r Sys.Date()`.
